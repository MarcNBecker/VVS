<polymer-element name="vvs-uebersicht">
	<template>
		<link rel="stylesheet" type="text/css" href="../../css/elements.css" shim-shadowdom>
		<core-media-query query="max-width: 1600px" queryMatches="{{smallScreen}}"></core-media-query>
		<core-media-query query="max-width: 950px" queryMatches="{{verySmallScreen}}"></core-media-query>
		<!-- Main DIV -->
		<div vertical layout>
			<!-- Group One -->
			<div vertical?="{{smallScreen}}" horizontal?="{{!smallScreen}}" layout>
				<!-- Dozent -->
				<div vertical layout class="vertical-input" auto-vertical?="{{smallScreen}}" flex?="{{!smallScreen}}">
					<div horizontal layout center>
						<span class="headline">Dozentendaten verwalten</span>
						<paper-spinner active?="{{toggleDisableDozent}}" self-center></paper-spinner>
					</div>
					<div vertical?="{{verySmallScreen}}" horizontal?="{{!verySmallScreen}}" layout center-center?="{{!verySmallScreen}}" start?="{{verySmallScreen}}" class="horizontal-verticalizable horizontal-input horizontal-button-bar">
						<paper-dropdown-menu label="Dozent" disabled?="{{toggleDisableDozent}}" auto-vertical?="{{verySmallScreen}}" flex?="{{!verySmallScreen}}">
							<paper-dropdown class="dropdown">
								<core-menu id="dozent" class="menu">
									<template repeat="{{item in dozenten}}">
										<paper-item>{{item.name}}, {{item.vorname}}</paper-item>
									</template>
								</core-menu>
							</paper-dropdown>
						</paper-dropdown-menu>					
						<paper-button on-click={{updateDozent}} raised disabled?="{{toggleDisableDozent}}" auto-vertical?="{{verySmallScreen}}">anzeigen/bearbeiten/l&ouml;schen</paper-button>
						<paper-button on-click={{printPlanDozent}} raised disabled?="{{toggleDisableDozent}}" auto-vertical?="{{verySmallScreen}}">Dozentenplan drucken</paper-button>
					</div>
					<div horizontal layout start class="horizontal-input horizontal-button-bar">
						<paper-button on-click={{createDozent}} raised>neuen Dozenten anlegen</paper-button>
					</div>	
				</div>
				<!-- Kurs -->
				<div vertical layout class="vertical-input" auto-vertical?="{{smallScreen}}" flex?="{{!smallScreen}}">						
					<div horizontal layout center>
						<span class="headline">Kursdaten verwalten</span>
						<paper-spinner active?="{{toggleDisableKurs}}" self-center></paper-spinner>
					</div>
					<div vertical?="{{verySmallScreen}}" horizontal?="{{!verySmallScreen}}" layout center-center?="{{!verySmallScreen}}" start?="{{verySmallScreen}}" class="horizontal-verticalizable horizontal-input horizontal-button-bar">
						<paper-dropdown-menu label="Kurs" disabled?="{{toggleDisableKurs}}" auto-vertical?="{{verySmallScreen}}" flex?="{{!verySmallScreen}}">
							<paper-dropdown class="dropdown">
								<core-menu id="kurs" class="menu">
									<template repeat="{{item in kurse}}">
										<paper-item>{{item.kursname}}</paper-item>
									</template>
								</core-menu>
							</paper-dropdown>
						</paper-dropdown-menu>						
						<paper-button on-click={{updateKurs}} raised disabled?="{{toggleDisableKurs}}" auto-vertical?="{{verySmallScreen}}" flex?="{{!verySmallScreen}}">anzeigen/bearbeiten/l&ouml;schen</paper-button>
					</div>
					<div horizontal layout start class="horizontal-input horizontal-list">
						<paper-button on-click={{createKurs}} raised>neuen Kurs anlegen</paper-button>				
					</div>
				</div>
			</div>
			<!-- Group Two -->
			<div vertical?="{{smallScreen}}" horizontal?="{{!smallScreen}}" layout>
				<!-- Modulplan -->	
				<div vertical layout class="vertical-input" auto-vertical?="{{smallScreen}}" flex?="{{!smallScreen}}">
					<div horizontal layout center>
						<span class="headline">Modulplan verwalten</span>
						<paper-spinner active?="{{toggleDisableModulplan}}" self-center></paper-spinner>
					</div>
					<div vertical?="{{verySmallScreen}}" horizontal?="{{!verySmallScreen}}" layout center-center?="{{!verySmallScreen}}" start?="{{verySmallScreen}}" class="horizontal-verticalizable horizontal-input horizontal-button-bar">
						<paper-dropdown-menu label="Modulplan" disabled?="{{toggleDisableModulplan}}" auto-vertical?="{{verySmallScreen}}" flex?="{{!verySmallScreen}}">
							<paper-dropdown class="dropdown">
								<core-menu id="modulplan" class="menu">
									<template repeat="{{item in modulplaene}}">
										<paper-item>{{item.studiengang}} - {{item.vertiefungsrichtung}}</paper-item>
									</template>
								</core-menu>
							</paper-dropdown>
						</paper-dropdown-menu>					
						<paper-button on-click={{updateModulplan}} raised disabled?="{{toggleDisableModulplan}}" auto-vertical?="{{verySmallScreen}}" flex?="{{!verySmallScreen}}">anzeigen/bearbeiten/l&ouml;schen</paper-button>
					</div>
					<div horizontal layout start class="horizontal-list">
						<paper-button on-click={{createModulplan}} raised>neuen Modulplan anlegen</paper-button>			
					</div>
				</div>						
				<!-- Feiertage -->
				<div vertical layout class="vertical-input" auto-vertical?="{{smallScreen}}" flex?="{{!smallScreen}}">
					<div horizontal layout center>
						<span class="headline">Feiertage verwalten</span>		
						<paper-spinner active?="{{toggleDisableFeiertag}}" self-center></paper-spinner>
					</div>		
					<div vertical?="{{verySmallScreen}}" horizontal?="{{!verySmallScreen}}" layout center-center?="{{!verySmallScreen}}" start?="{{verySmallScreen}}" class="horizontal-verticalizable horizontal-input horizontal-button-bar">
						<paper-dropdown-menu label="Jahr" disabled?="{{toggleDisableFeiertag}}" auto-vertical?="{{verySmallScreen}}" flex?="{{!verySmallScreen}}">
							<paper-dropdown class="dropdown">
								<core-menu id="jahr" class="menu">
									<template repeat="{{item in jahre}}">
										<paper-item>{{item}}</paper-item>
									</template>
								</core-menu>
							</paper-dropdown>
						</paper-dropdown-menu>						
						<paper-button on-click={{updateFeiertage}} raised disabled?="{{toggleDisableFeiertag}}" auto-vertical?="{{verySmallScreen}}" flex?="{{!verySmallScreen}}">pflegen</paper-button>
					</div>
				</div>
			</div>
			<!-- Toasts -->
			<paper-toast id="toast_error" text="Leider ist ein Fehler aufgetreten. Bitte laden Sie die Seite neu!" duration="15000">
				<div on-click={{refresh}}>REFRESH</div>
			</paper-toast>		
		</div>
	</template>
	<script type="text/javascript">
		Polymer('vvs-uebersicht', {
			dozenten: [],
			kurse: [],
			modulplaene: [],
			jahre: [],
			toggleDisableDozent: true,
			toggleDisableKurs: true,
			toggleDisableModulplan: true,
			toggleDisableFeiertag: true,
			publish: {
				pageParameter: {},
				pageLoaded: {},
				pageDescriptor: {},
				refresh: function() {}
			},
    		ready: function()
    		{
    			var self = this;
    			self.dozenten = [];
    			self.kurse = [];
    			self.modulplaene = [];
    			self.jahre = [];
    			self.toggleDisableDozent = true;
    			self.toggleDisableKurs = true;
    			self.toggleDisableModulplan = true;
    			self.toggleDisableFeiertag = true;
    			model.webService.getAllDozenten(function(api) {
					if (!api.isError)
					{
						self.dozenten = api.response;
						self.toggleDisableDozent = false;
					}
					else
					{
						console.log(JSON.stringify(api));
						self.$.toast_error.show();
					}
				});
    			model.webService.getAllKurse(function(api) {
					if (!api.isError)
					{
						self.kurse = api.response;
						self.toggleDisableKurs = false;
					}
					else
					{
						console.log(JSON.stringify(api));
						self.$.toast_error.show();
					}
				});
    			model.webService.getAllModulplaene(function(api) {
					if (!api.isError)
					{
						self.modulplaene = api.response;
						self.toggleDisableModulplan = false;
					}
					else
					{
						console.log(JSON.stringify(api));
						self.$.toast_error.show();
					}
				});
    			var aktuellesDatum = new Date();
    			var aktuellesJahr = aktuellesDatum.getFullYear();
    			aktuellesJahr = aktuellesJahr - 1;
    			self.jahre.push(aktuellesJahr);
    			aktuellesJahr = aktuellesJahr + 1;
    			self.jahre.push(aktuellesJahr);
    			aktuellesJahr = aktuellesJahr + 1;
    			self.jahre.push(aktuellesJahr);
    			aktuellesJahr = aktuellesJahr + 1;
    			self.jahre.push(aktuellesJahr);
    			self.toggleDisableFeiertag = false;
    		},
    		createDozent: function() {
    			var self = this;
    			self.pageLoaded.dozent = false;
    			self.pageParameter.dozent.id = 0;
    			location.href = "#" + self.pageDescriptor.dozent.hash;
    		},
    		updateDozent: function() {
    			var self = this;
    			if (self.$.dozent.selected !== null && self.dozenten.length > 0)
				{
					self.pageLoaded.dozent = false;
					self.pageParameter.dozent.id = self.dozenten[self.$.dozent.selected].id;
					location.href = "#" + self.pageDescriptor.dozent.hash
				}
    		},
    		printPlanDozent: function() {
    			var self = this;
				if (self.$.dozent.selected !== null && self.dozenten.length > 0)
				{
					//TODO navigate to Dozent Plan with ID = self.dozenten[self.$.dozent.selected].id;
				}
    		},
    		createKurs: function() {
    			var self = this; 
    			//TODO navigate to Kurs pflegen with ID = 0
    		},
    		updateKurs: function() {
    			var self = this;
				if (self.$.kurs.selected !== null && self.kurse.length > 0)
				{
					//TODO navigate to Kurs pflegen with ID = self.kurse[self.$.kurs.selected].id;
					
				}
    		},
    		createModulplan: function() {
    			var self = this;
    			self.pageLoaded.modulplanAnlegen = false;
    			location.href = "#" + self.pageDescriptor.modulplanAnlegen.hash;
    		},
    		updateModulplan: function() {
    			var self = this;
				if (self.$.modulplan.selected !== null && self.modulplaene.length > 0)
				{
					//TODO navigate to Modulplan pflegen with ID = self.modulplaene[self.$.modulplan.selected].id;
				}
    		},
    		updateFeiertage: function() {
    			var self = this;
				if (self.$.jahr.selected !== null && self.jahre.length > 0)
				{
					//TODO navigate to Feiertag pflegen with ID = self.jahre[self.$.jahr.selected];
				}
    		}
 		});
	 </script>
</polymer-element>